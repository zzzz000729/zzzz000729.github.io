(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-ba2fe57c"],{"3c77":function(t,e,a){"use strict";a.r(e);var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"wrapper"},[a("van-nav-bar",{attrs:{title:"个人信息","left-arrow":""},on:{"click-left":t.toBack}}),a("div",{staticClass:"main"},[a("van-cell",{attrs:{title:"头像","is-link":"",size:"large",center:""},scopedSlots:t._u([{key:"right-icon",fn:function(){return[a("img",{staticClass:"avatar",attrs:{src:t.userinfo.avatar,alt:""},on:{click:function(e){t.showimg=!0}}})]},proxy:!0}])}),a("van-cell",{attrs:{title:"昵称","is-link":"",value:t.userinfo.nickname,size:"large"},on:{click:function(e){return t.toName(t.userinfo.nickname)}}}),a("van-cell",{attrs:{title:"手机号","is-link":"",value:t.userinfo.mobile,size:"large"}}),a("van-cell",{attrs:{title:"性别","is-link":"",value:0==t.userinfo.sex?"女":"男",size:"large"},on:{click:t.toSex}}),a("van-cell",{attrs:{title:"出生日期","is-link":"",value:t.userinfo.birthday,size:"large"},on:{click:function(e){t.showdate=!0}}}),a("van-cell",{attrs:{title:"所在城市","is-link":"",value:t.userinfo.province_name+"，"+t.userinfo.city_name+"，"+t.userinfo.district_name,size:"large"},on:{click:function(e){t.showcity=!0}}})],1),a("van-popup",{style:{height:"20%"},attrs:{position:"bottom"},model:{value:t.showimg,callback:function(e){t.showimg=e},expression:"showimg"}},[a("van-button",{attrs:{type:"default",block:""}},[t._v("拍照")]),a("van-uploader",{staticStyle:{width:"100%"},attrs:{"after-read":t.onRead,accept:"image/*"}},[a("van-button",{staticStyle:{width:"100vw"},attrs:{type:"default",block:""}},[t._v("从手机相册选择")])],1),a("van-button",{attrs:{type:"default",block:""},on:{click:function(e){t.showimg=!1}}},[t._v("取消")])],1),a("van-popup",{style:{height:"40%"},attrs:{position:"bottom"},model:{value:t.showdate,callback:function(e){t.showdate=e},expression:"showdate"}},[a("van-datetime-picker",{attrs:{type:"date",title:"选择年月日","min-date":t.minDate,"max-date":t.maxDate},on:{confirm:t.updateDate,cancel:function(e){t.showdate=!1}},model:{value:t.currentDate,callback:function(e){t.currentDate=e},expression:"currentDate"}})],1),a("van-popup",{style:{height:"45%"},attrs:{position:"bottom"},model:{value:t.showcity,callback:function(e){t.showcity=e},expression:"showcity"}},[a("van-area",{attrs:{"area-list":t.areaList},on:{confirm:t.updateCity,cancel:function(e){t.showdate=!1}}})],1),a("van-popup",{style:{height:"45%"},attrs:{position:"bottom"},model:{value:t.showgrade,callback:function(e){t.showgrade=e},expression:"showgrade"}},[a("van-picker",{attrs:{"show-toolbar":"",columns:t.gradelist},on:{confirm:t.updateGrade,cancel:function(e){t.showgrade=!1}}})],1)],1)},i=[],o=(a("4160"),a("159b"),a("e7e5"),a("d399")),s=a("cbf8"),r={data:function(){return{userinfo:"",subject:"",grade:"",showdate:!1,minDate:new Date(1970,0,1),maxDate:new Date,currentDate:new Date,timer:"",showimg:!1,showcity:!1,areaList:s["a"],gradelist:[],showgrade:!1,attr:[]}},mounted:function(){this.getUserInfo()},methods:{getUserInfo:function(){var t=this;this.$http.userinfo().then((function(e){t.userinfo=e.data.data,e.data.data.attr.length>0&&e.data.data.attr.forEach((function(e){"年级"==e.attr&&(t.grade=e.attr_value),"学科"==e.attr&&(t.subject+=e.attr_value+" ")}))})),this.$http.subject().then((function(t){}))},onRead:function(t){var e=this,a=new FormData;a.append("file",t.file),this.$http.updateimg(a).then((function(t){var a=t.data.data.path;e.showimg=!1,e.$http.updateuser({avatar:a}).then((function(t){e.getUserInfo(),Object(o["a"])("修改成功")}))}))},toBack:function(){this.$router.push("/my")},toName:function(t){this.$router.push({path:"/updatename",query:{name:t}})},toSex:function(){this.$router.push("/updatesex")},updateDate:function(t){var e=this,a=new Date(t),n=a.getFullYear(),i=a.getMonth()+1,o=a.getDate(),s=a.getHours(),r=a.getMinutes();i<10&&(i="0"+i),o<10&&(o="0"+o),s<10&&(s="0"+s),r<10&&(r="0"+r),this.timer=n+"-"+i+"-"+o,this.$http.updateuser({birthday:this.timer}).then((function(t){e.showdate=!1,e.getUserInfo()}))},updateCity:function(t){var e=this,a=t[0].code,n=t[2].code,i=t[1].code;this.$http.updateuser({city_id:a,district_id:n,province_id:i}).then((function(t){e.getUserInfo()})),this.showcity=!1},toSubject:function(){this.$router.push("/updatesubject")},updateGrade:function(t){var e=this;this.showgrade=!1;var a=[];a.push({attr_id:1,attr_val_id:t.id},{attr_id:2,attr_val_id:24}),this.attr=a,this.$http.updateuser({user_attr:JSON.stringify(this.attr)}).then((function(t){e.getUserInfo()}))}}},c=r,u=(a("f991"),a("2877")),l=Object(u["a"])(c,n,i,!1,null,"7cf742cc",null);e["default"]=l.exports},"78d7":function(t,e,a){},f991:function(t,e,a){"use strict";a("78d7")}}]);